"use strict";var app=angular.module("zenefits_challenge",["angularSpinner","ngMessages","ui.materialize"]);app.config(["usSpinnerConfigProvider",function(e){e.setTheme("zenefits_orange",{color:"#FAAE42",radius:10})}]),app.controller("searchCtrl",["$scope","$log",function(e,o){function r(){"$apply"!==e.$root.$$phase&&"$digest"!==e.$root.$$phase&&e.$apply()}function a(e){swal({title:"Oops!",type:"error",text:"no query provided!",timer:1e3,showConfirmButton:!1})}function n(a,n,i){if(n==google.maps.places.PlacesServiceStatus.OK){var s=t(a);e.places=s,e.placesLoad=!1,o.info(e.places),e.reload=!0,e.queryString="",r()}else o.err("places service is non operational")}function t(e){var o=e.map(function(e){if(e.photos&&(e.photo=e.photos[0].html_attributions[0].match(/https:\/\/.+?(?=")/i)[0]),e.price_level){var o="$";e.price=o.repeat(e.price_level)}return e});return o}var i=void 0,s=void 0,l=void 0;e.places,e.reload=!1,function(){e.navigatorLoad=!0,"geolocation"in navigator?navigator.geolocation.getCurrentPosition(function(o){l=new google.maps.LatLng(o.coords.latitude,o.coords.longitude),i=new google.maps.Map({center:l,zoom:15}),e.navigatorLoad=!1,r()}):o.error("geolocation is not available!")}(),e.search=function(o){if(e.reload=!1,!o)return void a("no query provided");e.places=[],e.placesLoad=!0;var r={location:l,radius:"200",query:o};s=new google.maps.places.PlacesService(i),s.textSearch(r,n)}}]),app.filter("ratingQuality",function(){return function(e){var o=parseInt(e);return 2>=o?"bad":o>2&&3.5>=o?"ok":"amazing"}}),app.filter("ratingExists",function(){return function(e){var o=[];return angular.forEach(e,function(e){e.hasOwnProperty("rating")&&o.push(e)}),o.sort(function(e,o){return o.rating-e.rating}),o}});