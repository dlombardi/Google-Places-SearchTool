"use strict";var app=angular.module("zenefits_challenge",["angularSpinner","ngMessages","ui.materialize"]);app.config(["usSpinnerConfigProvider",function(o){o.setTheme("zenefits_orange",{color:"#FAAE42",radius:10})}]),app.controller("searchCtrl",["$scope","$log",function(o,e){function a(){"$apply"!==o.$root.$$phase&&"$digest"!==o.$root.$$phase&&o.$apply()}function r(e){swal({title:"Oops!",type:"error",text:e,timer:1500,showConfirmButton:!1}),o.reload=!0,o.placesLoad=!1,o.navigatorLoad=!1,a()}function t(e,t,i){if(t==google.maps.places.PlacesServiceStatus.OK){var l=n(e);o.places=l,o.placesLoad=!1,o.reload=!0,o.queryString="",a()}else r("No results found!")}function n(o){var e=o.map(function(o){if(o.photos&&(o.photo=o.photos[0].html_attributions[0].match(/https:\/\/.+?(?=")/i)[0]),o.price_level){var e="$";o.price=e.repeat(o.price_level)}return o});return e}var i=void 0,l=void 0,s=void 0;o.places,o.reload=!1,function(){o.navigatorLoad=!0,"geolocation"in navigator?navigator.geolocation.getCurrentPosition(function(e){s=new google.maps.LatLng(e.coords.latitude,e.coords.longitude),i=new google.maps.Map({center:s,zoom:15}),o.navigatorLoad=!1,a()}):e.error("geolocation is not available!")}(),o.search=function(e){if(o.reload=!1,!e)return void r("no query provided");o.places=[],o.placesLoad=!0;var a={location:s,radius:"200",query:e};l=new google.maps.places.PlacesService(i),l.textSearch(a,t)}}]),app.filter("ratingQuality",function(){return function(o){var e=parseInt(o);return 2>=e?"bad":e>2&&3.5>=e?"ok":"amazing"}}),app.filter("ratingExists",function(){return function(o){var e=[];return angular.forEach(o,function(o){o.hasOwnProperty("rating")&&e.push(o)}),e.sort(function(o,e){return e.rating-o.rating}),e}});