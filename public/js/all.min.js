"use strict";var app=angular.module("google_places_search",["angularSpinner","ngMessages","ui.materialize"]);app.config(["usSpinnerConfigProvider",function(o){o.setTheme("zenefits_orange",{color:"#FAAE42",radius:10})}]),app.filter("ratingQuality",function(){return function(o){var a=parseInt(o);return 2>=a?"bad":a>2&&3.5>=a?"ok":"amazing"}}),app.filter("ratingExists",function(){return function(o){var a=[];return angular.forEach(o,function(o){o.hasOwnProperty("rating")&&a.push(o)}),a.sort(function(o,a){return a.rating-o.rating}),a}}),app.controller("searchCtrl",["$scope","$log",function(o,a){function e(){"$apply"!==o.$root.$$phase&&"$digest"!==o.$root.$$phase&&o.$apply()}function r(a,r,i){if(r==google.maps.places.PlacesServiceStatus.OK){var l=n(a);o.places=l,o.placesLoad=!1,o.reload=!0,o.queryString="",e()}else t("No results found!")}function t(a){swal({title:a,type:"error",timer:1500,showConfirmButton:!1}),o.reload=!0,o.placesLoad=!1,o.navigatorLoad=!1,e()}function n(o){var a=o.map(function(o){if(o.photos&&(o.photo=o.photos[0].html_attributions[0].match(/https:\/\/.+?(?=")/i)[0]),o.price_level){var a="$";o.price=a.repeat(o.price_level)}return o});return a}var i=void 0,l=void 0,s=void 0;o.places,o.reload=!1,function(){o.navigatorLoad=!0,"geolocation"in navigator?navigator.geolocation.getCurrentPosition(function(a){s=new google.maps.LatLng(a.coords.latitude,a.coords.longitude),i=new google.maps.Map({center:s,zoom:15}),o.navigatorLoad=!1,e()}):t("Geolocation not available!")}(),o.search=function(a){if(o.reload=!1,!a)return void t("No query provided");o.places=[],o.placesLoad=!0;var e={location:s,radius:"200",query:a};l=new google.maps.places.PlacesService(i),l.textSearch(e,r)}}]);